import pandas as pd
import spacy

# Загрузка модели spaCy для русского языка
nlp = spacy.load("ru_core_news_sm")

# Пример текста анамнеза
text = """
Сознание сохранено. Ориентирована во времени, месте, личности правильно. 
Поля зрения ориентировочно не нарушены. Острота зрения ОD=0,7; OS=0,6. 
Установочный нистагм при крайних отведениях глаз. Реакция на свет сохранена. 
Движения в конечностях в полном объеме. Тонус мышц не изменен. 
В позе Ромберга неустойчива. Координаторные пробы выполняет с интенцией с двух сторон.
"""

# Ключевые слова для разметки
keywords = {
    "Зрительная": ["поле зрения", "острота зрения", "зрачки", "скотома", "сужение поля зрения"],
    "Стволовая": ["нистагм", "реакция на свет", "лицевая мускулатура", "дизартрия"],
    "Пирамидная": ["движения в конечностях", "мышечная сила", "тонус мышц", "парапарез"],
    "Мозжечковая": ["поза Ромберга", "координаторные пробы", "атаксия", "тремор"],
    "Чувствительная": ["вибрационная чувствительность", "глубокая чувствительность", "парастезии"],
    "Тазовые": ["недержание мочи", "задержка мочи", "дисфункция кишечника"],
    "Амб. индекс": ["проходит метров", "утомляемость при ходьбе"]
}

# Функция для разметки текста
def annotate_text(text, keywords):
    doc = nlp(text)
    annotations = {key: "Нет" for key in keywords}  # Инициализация разметки

    for key, phrases in keywords.items():
        for phrase in phrases:
            if phrase.lower() in text.lower():
                annotations[key] = "Да"
                break

    return annotations

# Применение функции к тексту
annotations = annotate_text(text, keywords)

# Создание датасета
data = {
    "Текст анамнеза": [text],
    **annotations
}

df = pd.DataFrame(data)

# Вывод датасета
print(df)